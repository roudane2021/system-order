"use strict";(self.webpackChunkorder_ihm=self.webpackChunkorder_ihm||[]).push([[484],{3484:(fe,B,l)=>{l.r(B),l.d(B,{OrderModule:()=>de});var Q=l(9299),t=l(4650),y=l(2722),G=l(9300),N=l(3900),h=(()=>{return(r=h||(h={})).NONE="NONE",r.OPEN_PANEL="OPEN_PANEL",r.CLOSE_PANEL="CLOSE_PANEL",r.VIEW_ORDER="VIEW_ORDER",r.DELETE_ORDER="DELETE_ORDER",r.UPDATE_ORDER="UPDATE_ORDER",r.CREATE_ORDER="CREATE_ORDER",h;var r})(),L=l(1135),A=l(7579),lt=l(9841),f=l(8505),x=l(262),Y=l(515),I=l(2843),_=l(4004);const g_endpoints_orders="/orders",g_pagination_defaultPage=0,g_pagination_defaultSize=10;var q=(()=>{return(r=q||(q={})).PENDING="PENDING",r.CONFIRMED="CONFIRMED",r.SHIPPED="SHIPPED",r.DELIVERED="DELIVERED",r.CANCELLED="CANCELLED",q;var r})(),z=l(529),H=l(9646);const j={GET_ORDER:`http://localhost:3000${g_endpoints_orders}`,SAVE_ORDER:`http://localhost:3000${g_endpoints_orders}`,DELETE_ORDER:`http://localhost:3000${g_endpoints_orders}`};let w=(()=>{const o=class{constructor(){this.enableDebug=true}debug(e,...i){this.enableDebug&&console.log("[DEBUG]",e,...i)}info(e,...i){console.info("[INFO]",e,...i)}warn(e,...i){console.warn("[WARN]",e,...i)}error(e,...i){console.error("[ERROR]",e,...i)}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),r})(),K=(()=>{const o=class{constructor(){this.http=(0,t.f3M)(z.eN),this.logService=(0,t.f3M)(w)}getOrders(e=g_pagination_defaultPage,i=[]){const a=g_pagination_defaultSize,m=j.GET_ORDER;this.logService.debug("getOrders : ",e,i);const c=(new z.LE).set("page",e.toString()).set("size",a.toString());return this.http.get(m,{params:c}).pipe((0,x.K)(p=>(this.logService.error("Erreur getOrders",p),(0,I._)(()=>p))))}saveOrder(e){return this.logService.debug("saveOrder : ",e),this.http.get(j.SAVE_ORDER)}deleteOrder(e){return this.logService.debug("deleteOrder : ",e),(0,H.of)(void 0)}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),r})(),W=(()=>{const o=class{constructor(){this.orderService=(0,t.f3M)(K),this.logService=(0,t.f3M)(w)}getOrders(e,i){return this.orderService.getOrders(e,i).pipe((0,f.b)(()=>this.logService.info(`Chargement commandes page ${e}`)),(0,x.K)(a=>(this.logService.error("Erreur lors du chargement des commandes",a),(0,I._)(()=>a))))}deleteOrder(e){return this.orderService.deleteOrder(e).pipe((0,f.b)(()=>this.logService.info(`Suppression commande ${e.orderNumber}`)),(0,x.K)(i=>(this.logService.error("Erreur suppression commande",i),(0,I._)(()=>i))))}saveOrder(e){return this.orderService.saveOrder(e).pipe((0,f.b)(()=>this.logService.info(`Enregistrer commande ${e.orderNumber}`)),(0,x.K)(i=>(this.logService.error("Erreur Enregistrer commande",i),(0,I._)(()=>i))))}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),r})();var U=l(5412),d=l(6895),T=l(4859),mt=l(5829);function ct(r,o){if(1&r){const s=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(s);const i=t.oxw();return t.KtG(i.onCancel())}),t._uU(1),t.qZA()}if(2&r){const s=t.oxw();t.xp6(1),t.hij(" ",s.data.cancelText," ")}}const ut=function(r,o,s,e){return{"text-green-600":r,"text-red-600":o,"text-yellow-600":s,"text-blue-600":e}};let R=(()=>{const o=class{constructor(){this.data=(0,t.f3M)(U.WI),this.dialogRef=(0,t.f3M)(U.so)}onConfirm(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-info-dialog"]],decls:10,vars:10,consts:[["mat-dialog-title",""],[3,"ngClass"],[1,"mt-2"],["align","end",1,"mt-3"],["mat-button","",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-button","",3,"click"]],template:function(i,a){1&i&&(t.TgZ(0,"h2",0)(1,"span",1),t._uU(2),t.qZA()(),t.TgZ(3,"mat-dialog-content",2)(4,"p"),t._uU(5),t.qZA()(),t.TgZ(6,"mat-dialog-actions",3),t.YNc(7,ct,2,1,"button",4),t.TgZ(8,"button",5),t.NdJ("click",function(){return a.onConfirm()}),t._uU(9),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngClass",t.l5B(5,ut,"success"===a.data.type,"error"===a.data.type,"warning"===a.data.type,"info"===a.data.type)),t.xp6(1),t.hij(" ",a.data.title||"Information"," "),t.xp6(3),t.Oqu(a.data.message),t.xp6(2),t.Q6J("ngIf",a.data.cancelText),t.xp6(2),t.hij(" ",a.data.confirmText||"OK"," "))},dependencies:[d.mk,d.O5,T.lW,U.uh,U.xY,U.H8,mt.oO],styles:["mat-dialog-content[_ngcontent-%COMP%]{font-size:15px;color:#333}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px}"]}),r})();var v=(()=>{return(r=v||(v={})).INFO="info",r.SUCCESS="success",r.WARNING="warning",r.ERROR="error",v;var r})();let M=(()=>{const o=class{constructor(){this.dialog=(0,t.f3M)(U.uw)}info(e,i="Information"){this.dialog.open(R,{width:"400px",data:{title:i,message:e,type:"info",confirmText:"OK"}})}success(e,i="Succ\xe8s"){this.dialog.open(R,{width:"400px",data:{title:i,message:e,type:v.SUCCESS,confirmText:"Fermer"}})}error(e,i="Erreur"){this.dialog.open(R,{width:"400px",data:{title:i,message:e,type:v.ERROR,confirmText:"Fermer"}})}confirm(e){return this.dialog.open(R,{width:"400px",data:{title:e.title??"Confirmation",message:e.message,type:e.type??v.WARNING,confirmText:e.confirmText??"Oui",cancelText:e.cancelText??"Non"}}).afterClosed()}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),r})();let F=(()=>{const o=class{constructor(){this._state$=new L.X({page:g_pagination_defaultPage,criteria:[]}),this._ordersSubject$=new L.X(this.getDefaultResult()),this._errorSubject$=new A.x,this._refresh$=new L.X(void 0),this.destroy$=new A.x,this.orderBusinessFacade=(0,t.f3M)(W),this.dialogService=(0,t.f3M)(M),this.mapFormToOrder=(e,i)=>{const a=e.value,{status:m=q.CONFIRMED,orderNumber:c="",orderDate:p=""}=i??{};return{orderNumber:c,orderDate:p,firstName:a.personalInfo.prenom,lastName:a.personalInfo.nom,city:a.personalInfo.ville,nationality:a.personalInfo.nationalite,email:"email"===a.contactPreference?a.email.email:"",phone:"phone"===a.contactPreference?a.phone:"",userName:a.loginInfo.username,password:a.loginInfo.password,status:m,items:a.items?.map(b=>({productId:b.productId,quantity:b.quantity,price:b.price}))}}}init(){(0,lt.a)([this._state$,this._refresh$]).pipe((0,y.R)(this.destroy$),(0,N.w)(([e])=>this.orderBusinessFacade.getOrders(e.page,e.criteria).pipe((0,f.b)(i=>{this._ordersSubject$.next(i)}),(0,x.K)(i=>(this._errorSubject$.next(i),Y.E))))).subscribe()}deleteOrder(e){return this.orderBusinessFacade.deleteOrder(e).pipe((0,y.R)(this.destroy$),(0,N.w)(()=>(0,I._)(()=>new Error("Erreur suppression"))),(0,f.b)(()=>this.refresh()),(0,x.K)(i=>(0,I._)(()=>i)))}saveOrder(e){this.orderBusinessFacade.saveOrder(e).pipe((0,f.b)(()=>{this.refresh(),this.dialogService.success((r=>`Commande #${r.orderNumber} est cr\xe9\xe9`)(e))}),(0,x.K)(()=>(this.dialogService.error((r=>`Commande #${r.orderNumber} n'est pas cr\xe9\xe9`)(e)),Y.E))).subscribe()}get order$(){return this._ordersSubject$.asObservable().pipe((0,_.U)(e=>e?.content))}get page$(){return this._ordersSubject$.asObservable().pipe((0,_.U)(this.extractPage))}get error$(){return this._errorSubject$.asObservable()}setPage(e){this._state$.next({...this._state$.value,page:e})}setCriteria(e){this._state$.next({page:g_pagination_defaultPage,criteria:e})}refresh(){this._refresh$.next()}destroy(){this.destroy$.next(),this.destroy$.complete()}extractPage(e){return{page:e?.page,size:e?.size,totalElements:e?.totalElements,totalPages:e?.totalPages}}getDefaultResult(){return{content:[],page:0,size:0,totalElements:0,totalPages:0}}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),r})();const X_confirmGeneric=r=>({title:"Confirmation",message:r,confirmText:"Oui",cancelText:"Non",type:v.WARNING});var dt=l(4482),tt=l(5403),pt=l(4671),ft=l(5963),ht=l(8421);let et=(()=>{const o=class{constructor(){this._action$=new A.x}get action$(){return this._action$.asObservable()}emit(e){this._action$.next(e)}clear(){this._action$.next({})}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),r})(),Ct=(()=>{const o=class{createComponent(e,i,a,m){e.clear();const c=e.createComponent(i);a&&Object.assign(c.instance,a);const p=c.instance;return p.eventClose?.subscribe&&m&&p.eventClose.subscribe(m),c}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),r})();class _t{constructor(){this.destroy$=new A.x,this.actionService=(0,t.f3M)(et),this.dynamicLoaderService=(0,t.f3M)(Ct),this.dialogService=(0,t.f3M)(M),this.logService=(0,t.f3M)(w)}init(){this.listenActions()}listenActions(){this.actionService.action$.pipe((0,y.R)(this.destroy$),(0,G.h)(o=>this.getSupportedActionTypes().includes(o.type)),(0,f.b)(o=>{this.logService.debug(`Handling action : ${o.type}`),this.handleAction(o)})).subscribe()}retryWithUserConfirmation(o,s,e){return o.pipe(function gt(r=1/0){let o;o=r&&"object"==typeof r?r:{count:r};const{count:s=1/0,delay:e,resetOnSuccess:i=!1}=o;return s<=0?pt.y:(0,dt.e)((a,m)=>{let p,c=0;const b=()=>{let at=!1;p=a.subscribe((0,tt.x)(m,J=>{i&&(c=0),m.next(J)},void 0,J=>{if(c++<s){const nt=()=>{p?(p.unsubscribe(),p=null,b()):at=!0};if(null!=e){const pe="number"==typeof e?(0,ft.H)(e):(0,ht.Xf)(e(J,c)),st=(0,tt.x)(m,()=>{st.unsubscribe(),nt()},()=>{m.complete()});pe.subscribe(st)}else nt()}else m.error(J)})),at&&(p.unsubscribe(),p=null,b())};b()})}({count:e,delay:i=>{const a=X_confirmGeneric(s);return this.dialogService.confirm(a).pipe((0,N.w)(m=>m?(0,H.of)(void 0):(0,I._)(()=>i)))}}))}destroy(){this.destroy$.next(),this.destroy$.complete()}}var n=l(4006),P=l(8675);const D=(r,o)=>s=>{if(!s.get(r)||!s.get(o))return{confirmEqual:"Invalid control Name"};const e=s.get(r)?.value,i=s.get(o)?.value;return e===i?null:{confirmEqual:{main:e,confirm:i}}};function rt(r){const o=r.errors;return o?r.hasError("required")?"Ce champ est requis":r.hasError("email")?"Merci d'entrer une adresse mail valide":r.hasError("minlength")?"Ce num\xe9ro de t\xe9l\xe9phone ne contient pas assez de chiffres":r.hasError("maxlength")?"Ce num\xe9ro de t\xe9l\xe9phone contient trop de chiffres":r.hasError("validValidator")?`Ce texte ${o?.validValidator} ne contient pas le mot VALID`:"Ce champ contient une erreur":""}var Z=l(3546),S=l(7392),C=l(9549),$=l(4144),k=l(1948),u=l(1576);let ot=(()=>{const o=class{constructor(){this.remove=new t.vpe}onRemove(){this.remove.emit(this.index)}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-order-item"]],inputs:{itemForm:"itemForm",index:"index"},outputs:{remove:"remove"},decls:22,vars:1,consts:[["fxLayout","row wrap","fxLayoutGap","10px",1,"form-row",3,"formGroup"],["appearance","fill","fxFlex","30"],["matInput","","type","number","formControlName","productId"],["appearance","fill","fxFlex","20"],["matInput","","type","number","formControlName","quantity"],["matInput","","type","number","formControlName","price"],["mat-icon-button","","color","warn",3,"click"]],template:function(i,a){1&i&&(t.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-label"),t._uU(3,"ID Produit"),t.qZA(),t._UZ(4,"input",2),t.TgZ(5,"mat-error"),t._uU(6," Produit requis "),t.qZA()(),t.TgZ(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Quantit\xe9"),t.qZA(),t._UZ(10,"input",4),t.TgZ(11,"mat-error"),t._uU(12," Quantit\xe9 \u2265 1 requise "),t.qZA()(),t.TgZ(13,"mat-form-field",1)(14,"mat-label"),t._uU(15,"Prix"),t.qZA(),t._UZ(16,"input",5),t.TgZ(17,"mat-error"),t._uU(18," Prix \u2265 0 requis "),t.qZA()(),t.TgZ(19,"button",6),t.NdJ("click",function(){return a.onRemove()}),t.TgZ(20,"mat-icon"),t._uU(21,"delete"),t.qZA()()()),2&i&&t.Q6J("formGroup",a.itemForm)},dependencies:[T.RK,S.Hw,C.KE,C.hX,C.TO,$.Nt,n.Fj,n.wV,n.JJ,n.JL,n.sg,n.u,u.xw,u.SQ,u.yH]}),r})();function Zt(r,o){1&r&&(t.TgZ(0,"small",26),t._uU(1," Les deux adresses ne correspondent pas"),t.qZA())}function Et(r,o){if(1&r&&(t.TgZ(0,"mat-card",15)(1,"mat-card-subtitle"),t._uU(2,"Email"),t.qZA(),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Adresse mail"),t.qZA(),t._UZ(7,"input",24),t.TgZ(8,"mat-error"),t._uU(9),t.qZA(),t.YNc(10,Zt,2,0,"small",18),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"mat-form-field",4)(13,"mat-label"),t._uU(14,"Confirmer votre adresse mail"),t.qZA(),t._UZ(15,"input",25),t.TgZ(16,"mat-error"),t._uU(17),t.qZA()()()()),2&r){const s=t.oxw();t.Q6J("formGroup",s.emailForm),t.xp6(9),t.Oqu(s.getErrorMessage(s.emailCtrl)),t.xp6(1),t.Q6J("ngIf",t.lcZ(11,4,s.showEmailError$)),t.xp6(7),t.Oqu(s.getErrorMessage(s.confirmEmailCtrl))}}function Tt(r,o){if(1&r&&(t.TgZ(0,"mat-card",9)(1,"mat-card-subtitle"),t._uU(2,"T\xe9l\xe9phone"),t.qZA(),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Num\xe9ro de t\xe9l\xe9phone"),t.qZA(),t._UZ(7,"input",27),t.TgZ(8,"mat-error"),t._uU(9),t.qZA()()()()),2&r){const s=t.oxw();t.xp6(7),t.Q6J("formControl",s.phoneCtrl),t.xp6(2),t.Oqu(s.getErrorMessage(s.phoneCtrl))}}function vt(r,o){1&r&&(t.TgZ(0,"small",26),t._uU(1," Les deux passwords ne correspondent pas"),t.qZA())}function Ot(r,o){if(1&r){const s=t.EpF();t.ynx(0),t.TgZ(1,"app-order-item",28),t.NdJ("remove",function(i){t.CHM(s);const a=t.oxw();return t.KtG(a.removeOrderItem(i))}),t.qZA(),t.BQk()}if(2&r){const s=o.index,e=t.oxw();t.xp6(1),t.Q6J("itemForm",e.getOrderItemFormGroup(s))("index",s)}}let yt=(()=>{const o=class{constructor(){this.formBuilder=(0,t.f3M)(n.qu),this.orderUiFacade=(0,t.f3M)(F),this.logService=(0,t.f3M)(w),this.eventClose=new t.vpe,this.initCreateOrderForm=()=>{this.createOrderForm=this.formBuilder.group({personalInfo:this.personalInfoForm,contactPreference:this.contactPreferenceCtrl,email:this.emailForm,phone:this.phoneCtrl,loginInfo:this.loginInfoForm,items:this.orderItemsForm})},this.initFormControls=()=>{this.personalInfoForm=this.formBuilder.group({prenom:this.formBuilder.control("",[n.kI.required]),nom:this.formBuilder.control("",[n.kI.required]),ville:this.formBuilder.control("",[n.kI.required]),nationalite:this.formBuilder.control("",[n.kI.required])}),this.contactPreferenceCtrl=this.formBuilder.control("phone"),this.emailCtrl=this.formBuilder.control("",[n.kI.required,n.kI.email]),this.confirmEmailCtrl=this.formBuilder.control("",[n.kI.required,n.kI.email]),this.emailForm=this.formBuilder.group({email:this.emailCtrl,confirmEmail:this.confirmEmailCtrl},{validators:[D("email","confirmEmail")],updateOn:"blur"}),this.phoneCtrl=this.formBuilder.control("",[n.kI.required]),this.passwordCtrl=this.formBuilder.control("",[n.kI.required]),this.confirmPasswordCtrl=this.formBuilder.control("",[n.kI.required]),this.loginInfoForm=this.formBuilder.group({username:this.formBuilder.control("",[n.kI.required]),password:this.passwordCtrl,confirmPassword:this.confirmPasswordCtrl},{validators:[D("password","confirmPassword")],updateOn:"blur"}),this.orderItemsForm=this.formBuilder.array([])},this.initObservable=()=>{this.showEmail$=this.contactPreferenceCtrl.valueChanges.pipe((0,P.O)(this.contactPreferenceCtrl.value),(0,_.U)(e=>"email"===e),(0,f.b)(e=>this.setEmailValidators(e))),this.showPhone$=this.contactPreferenceCtrl.valueChanges.pipe((0,P.O)(this.contactPreferenceCtrl.value),(0,_.U)(e=>"phone"===e),(0,f.b)(e=>this.setPhoneValidators(e))),this.showEmailError$=this.emailForm.statusChanges.pipe((0,_.U)(()=>this.emailForm.hasError("confirmEqual")&&!this.emailForm.hasError("email")&&this.emailCtrl.value&&this.confirmEmailCtrl.value)),this.showPasswordError$=this.loginInfoForm.statusChanges.pipe((0,_.U)(()=>this.passwordCtrl.value&&this.confirmPasswordCtrl.value&&this.loginInfoForm.hasError("confirmEqual")))},this.setEmailValidators=e=>{e?(this.emailCtrl.addValidators([n.kI.required,n.kI.email]),this.confirmEmailCtrl.addValidators([n.kI.required,n.kI.email])):(this.emailCtrl.clearValidators(),this.confirmEmailCtrl.clearValidators(),this.emailCtrl.patchValue(""),this.confirmEmailCtrl.patchValue("")),Object.values(this.emailForm.controls).forEach(i=>{i instanceof n.NI&&(i.updateValueAndValidity(),i.markAsPristine(),i.markAsUntouched())})},this.setPhoneValidators=e=>{e?this.phoneCtrl.addValidators([n.kI.required]):(this.phoneCtrl.clearValidators(),this.phoneCtrl.patchValue("")),this.phoneCtrl.updateValueAndValidity(),this.phoneCtrl.markAsPristine(),this.phoneCtrl.markAsUntouched()}}ngOnInit(){this.initFormControls(),this.initCreateOrderForm(),this.initObservable()}addOrderItem(){this.orderItemsForm.push(this.createOrderItemGroup())}removeOrderItem(e){this.orderItemsForm.removeAt(e)}getOrderItemFormGroup(e){return this.orderItemsForm.at(e)}createOrderItemGroup(){return this.formBuilder.group({productId:[null,n.kI.required],quantity:[1,[n.kI.required,n.kI.min(1)]],price:[0,[n.kI.required,n.kI.min(0)]]})}onSubmitForm(){if(this.createOrderForm.markAllAsTouched(),this.createOrderForm.invalid)return;const e=this.orderUiFacade.mapFormToOrder(this.createOrderForm);this.logService.debug("updateOrder :",e),this.orderUiFacade.saveOrder(e),this.createOrderForm.reset(),this.eventClose.emit()}getErrorMessage(e){return rt(e)}onClose(){this.eventClose.emit()}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-order"]],outputs:{eventClose:"eventClose"},decls:81,vars:15,consts:[[3,"formGroup"],["mat-icon-button","","color","warn",3,"click"],["formGroupName","personalInfo",1,"form-card"],["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","start start",1,"form-row"],["appearance","fill","fxFlex","45"],["type","text","matInput","","formControlName","prenom"],["type","text","matInput","","formControlName","nom"],["type","text","matInput","","formControlName","ville"],["type","text","matInput","","formControlName","nationalite"],[1,"form-card"],[3,"formControl"],["value","email"],["value","phone"],["class","form-card",3,"formGroup",4,"ngIf"],["class","form-card",4,"ngIf"],[1,"form-card",3,"formGroup"],["type","text","matInput","","formControlName","username"],["type","password","matInput","","formControlName","password"],["class","error-text",4,"ngIf"],["type","password","matInput","","formControlName","confirmPassword"],["formArrayName","items"],[4,"ngFor","ngForOf"],["mat-stroked-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",3,"click"],["type","text","matInput","","formControlName","email"],["type","text","matInput","","formControlName","confirmEmail"],[1,"error-text"],["type","text","matInput","",3,"formControl"],[3,"itemForm","index","remove"]],template:function(i,a){1&i&&(t.TgZ(0,"mat-card",0)(1,"div")(2,"button",1),t.NdJ("click",function(){return a.onClose()}),t.TgZ(3,"mat-icon"),t._uU(4,"close"),t.qZA()()(),t.TgZ(5,"mat-card-title"),t._uU(6," Creation d'une Commande"),t.qZA(),t.TgZ(7,"mat-card",2)(8,"mat-card-subtitle"),t._uU(9,"Informationss personnelles"),t.qZA(),t.TgZ(10,"div",3)(11,"mat-form-field",4)(12,"mat-label"),t._uU(13,"Pr\xe9nom"),t.qZA(),t._UZ(14,"input",5),t.TgZ(15,"mat-error"),t._uU(16,"Ce champ est requis"),t.qZA()(),t.TgZ(17,"mat-form-field",4)(18,"mat-label"),t._uU(19,"Nom"),t.qZA(),t._UZ(20,"input",6),t.TgZ(21,"mat-error"),t._uU(22,"Ce champ est requis"),t.qZA()(),t.TgZ(23,"mat-form-field",4)(24,"mat-label"),t._uU(25,"Ville"),t.qZA(),t._UZ(26,"input",7),t.TgZ(27,"mat-error"),t._uU(28,"Ce champ est requis"),t.qZA()(),t.TgZ(29,"mat-form-field",4)(30,"mat-label"),t._uU(31,"Nationalit\xe9"),t.qZA(),t._UZ(32,"input",8),t.TgZ(33,"mat-error"),t._uU(34,"Ce champ est requis"),t.qZA()()()(),t.TgZ(35,"mat-card",9)(36,"mat-card-subtitle"),t._uU(37,"Comment pr\xe9f\xe9rez-vous que l'on vous contacte ?"),t.qZA(),t.TgZ(38,"mat-radio-group",10)(39,"mat-radio-button",11),t._uU(40,"Mail"),t.qZA(),t.TgZ(41,"mat-radio-button",12),t._uU(42,"T\xe9l\xe9phone"),t.qZA()()(),t.YNc(43,Et,18,6,"mat-card",13),t.ALo(44,"async"),t.YNc(45,Tt,10,2,"mat-card",14),t.ALo(46,"async"),t.TgZ(47,"mat-card",15)(48,"mat-card-subtitle"),t._uU(49,"Informations de connexion"),t.qZA(),t.TgZ(50,"div",3)(51,"mat-form-field",4)(52,"mat-label"),t._uU(53,"Nom d'utilisateur"),t.qZA(),t._UZ(54,"input",16),t.TgZ(55,"mat-error"),t._uU(56,"Ce champ est requis"),t.qZA()()(),t.TgZ(57,"div",3)(58,"mat-form-field",4)(59,"mat-label"),t._uU(60,"Mot de passe"),t.qZA(),t._UZ(61,"input",17),t.TgZ(62,"mat-error"),t._uU(63),t.qZA(),t.YNc(64,vt,2,0,"small",18),t.ALo(65,"async"),t.qZA(),t.TgZ(66,"mat-form-field",4)(67,"mat-label"),t._uU(68,"Confirmer votre mot de passe"),t.qZA(),t._UZ(69,"input",19),t.TgZ(70,"mat-error"),t._uU(71),t.qZA()()()(),t.TgZ(72,"mat-card",20)(73,"mat-card-subtitle"),t._uU(74,"Articles de la commande"),t.qZA(),t.YNc(75,Ot,2,2,"ng-container",21),t.TgZ(76,"button",22),t.NdJ("click",function(){return a.addOrderItem()}),t._uU(77,"Ajouter un article"),t.qZA()(),t.TgZ(78,"mat-card-actions")(79,"button",23),t.NdJ("click",function(){return a.onSubmitForm()}),t._uU(80,"ENREGISTRER"),t.qZA()()()),2&i&&(t.Q6J("formGroup",a.createOrderForm),t.xp6(38),t.Q6J("formControl",a.contactPreferenceCtrl),t.xp6(5),t.Q6J("ngIf",t.lcZ(44,9,a.showEmail$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(46,11,a.showPhone$)),t.xp6(2),t.Q6J("formGroup",a.loginInfoForm),t.xp6(16),t.Oqu(a.getErrorMessage(a.passwordCtrl)),t.xp6(1),t.Q6J("ngIf",t.lcZ(65,13,a.showPasswordError$)),t.xp6(7),t.Oqu(a.getErrorMessage(a.confirmPasswordCtrl)),t.xp6(4),t.Q6J("ngForOf",a.orderItemsForm.controls))},dependencies:[d.sg,d.O5,Z.a8,Z.hq,Z.$j,Z.n5,T.lW,T.RK,S.Hw,C.KE,C.hX,C.TO,$.Nt,k.VQ,k.U0,n.Fj,n.JJ,n.JL,n.oH,n.sg,n.u,n.x0,n.CE,u.xw,u.SQ,u.Wh,u.yH,ot,d.Ov],styles:[".error-text[_ngcontent-%COMP%]{color:red}"]}),r})();var it=l(7009);function xt(r,o){1&r&&(t.TgZ(0,"small",26),t._uU(1," Les deux adresses ne correspondent pas"),t.qZA())}function It(r,o){if(1&r&&(t.TgZ(0,"mat-card",15)(1,"mat-card-subtitle"),t._uU(2,"Email"),t.qZA(),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Adresse mail"),t.qZA(),t._UZ(7,"input",24),t.TgZ(8,"mat-error"),t._uU(9),t.qZA(),t.YNc(10,xt,2,0,"small",18),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"mat-form-field",4)(13,"mat-label"),t._uU(14,"Confirmer votre adresse mail"),t.qZA(),t._UZ(15,"input",25),t.TgZ(16,"mat-error"),t._uU(17),t.qZA()()()()),2&r){const s=t.oxw();t.Q6J("formGroup",s.emailForm),t.xp6(9),t.Oqu(s.getErrorMessage(s.emailCtrl)),t.xp6(1),t.Q6J("ngIf",t.lcZ(11,4,s.showEmailError$)),t.xp6(7),t.Oqu(s.getErrorMessage(s.confirmEmailCtrl))}}function bt(r,o){if(1&r&&(t.TgZ(0,"mat-card",9)(1,"mat-card-subtitle"),t._uU(2,"T\xe9l\xe9phone"),t.qZA(),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Num\xe9ro de t\xe9l\xe9phone"),t.qZA(),t._UZ(7,"input",27),t.TgZ(8,"mat-error"),t._uU(9),t.qZA()()()()),2&r){const s=t.oxw();t.xp6(7),t.Q6J("formControl",s.phoneCtrl),t.xp6(2),t.Oqu(s.getErrorMessage(s.phoneCtrl))}}function At(r,o){1&r&&(t.TgZ(0,"small",26),t._uU(1," Les deux passwords ne correspondent pas"),t.qZA())}function Ut(r,o){if(1&r){const s=t.EpF();t.ynx(0),t.TgZ(1,"app-order-item",28),t.NdJ("remove",function(i){t.CHM(s);const a=t.oxw();return t.KtG(a.removeOrderItem(i))}),t.qZA(),t.BQk()}if(2&r){const s=o.index,e=t.oxw();t.xp6(1),t.Q6J("itemForm",e.getOrderItemFormGroup(s))("index",s)}}const Ft={VIEW_ORDER:(()=>{const o=class{constructor(){this.formBuilder=(0,t.f3M)(n.qu),this.orderUiFacade=(0,t.f3M)(F),this.snackBar=(0,t.f3M)(it.ux),this.eventClose=new t.vpe,this.initCreateOrderForm=()=>{this.createOrderForm=this.formBuilder.group({personalInfo:this.personalInfoForm,contactPreference:this.contactPreferenceCtrl,email:this.emailForm,phone:this.phoneCtrl,loginInfo:this.loginInfoForm,items:this.orderItemsForm})},this.initFormControls=()=>{this.personalInfoForm=this.formBuilder.group({prenom:this.formBuilder.control("",[n.kI.required]),nom:this.formBuilder.control("",[n.kI.required]),ville:this.formBuilder.control("",[n.kI.required]),nationalite:this.formBuilder.control("",[n.kI.required])}),this.contactPreferenceCtrl=this.formBuilder.control(""),this.emailCtrl=this.formBuilder.control("",[n.kI.required,n.kI.email]),this.confirmEmailCtrl=this.formBuilder.control("",[n.kI.required,n.kI.email]),this.emailForm=this.formBuilder.group({email:this.emailCtrl,confirmEmail:this.confirmEmailCtrl},{validators:[D("email","confirmEmail")],updateOn:"blur"}),this.phoneCtrl=this.formBuilder.control("",[n.kI.required]),this.passwordCtrl=this.formBuilder.control("",[n.kI.required]),this.confirmPasswordCtrl=this.formBuilder.control("",[n.kI.required]),this.loginInfoForm=this.formBuilder.group({username:this.formBuilder.control("",[n.kI.required]),password:this.passwordCtrl,confirmPassword:this.confirmPasswordCtrl},{validators:[D("password","confirmPassword")],updateOn:"blur"}),this.orderItemsForm=this.formBuilder.array([])},this.initObservable=()=>{this.showEmail$=this.contactPreferenceCtrl.valueChanges.pipe((0,P.O)(this.contactPreferenceCtrl.value),(0,_.U)(e=>"email"===e),(0,f.b)(e=>this.setEmailValidators(e))),this.showPhone$=this.contactPreferenceCtrl.valueChanges.pipe((0,P.O)(this.contactPreferenceCtrl.value),(0,_.U)(e=>"phone"===e),(0,f.b)(e=>this.setPhoneValidators(e))),this.showEmailError$=this.emailForm.statusChanges.pipe((0,_.U)(()=>this.emailForm.hasError("confirmEqual")&&!this.emailForm.hasError("email")&&this.emailCtrl.value&&this.confirmEmailCtrl.value)),this.showPasswordError$=this.loginInfoForm.statusChanges.pipe((0,_.U)(()=>this.passwordCtrl.value&&this.confirmPasswordCtrl.value&&this.loginInfoForm.hasError("confirmEqual")))},this.setEmailValidators=e=>{e?(this.emailCtrl.addValidators([n.kI.required,n.kI.email]),this.confirmEmailCtrl.addValidators([n.kI.required,n.kI.email])):(this.emailCtrl.clearValidators(),this.confirmEmailCtrl.clearValidators(),this.emailCtrl.patchValue(""),this.confirmEmailCtrl.patchValue("")),Object.values(this.emailForm.controls).forEach(i=>{i instanceof n.NI&&(i.updateValueAndValidity(),i.markAsPristine(),i.markAsUntouched())})},this.setPhoneValidators=e=>{e?this.phoneCtrl.addValidators([n.kI.required]):(this.phoneCtrl.clearValidators(),this.phoneCtrl.patchValue("")),this.phoneCtrl.updateValueAndValidity(),this.phoneCtrl.markAsPristine(),this.phoneCtrl.markAsUntouched()}}ngOnInit(){this.initFormControls(),this.initCreateOrderForm(),this.populateForm(this.data),this.initObservable()}addOrderItem(){this.orderItemsForm.push(this.createOrderItemGroup())}removeOrderItem(e){this.orderItemsForm.removeAt(e)}getOrderItemFormGroup(e){return this.orderItemsForm.at(e)}createOrderItemGroup(){return this.formBuilder.group({productId:[null,n.kI.required],quantity:[1,[n.kI.required,n.kI.min(1)]],price:[0,[n.kI.required,n.kI.min(0)]]})}onSubmitForm(){if(this.createOrderForm.markAllAsTouched(),this.createOrderForm.invalid)return;const e=this.orderUiFacade.mapFormToOrder(this.createOrderForm,this.data);this.orderUiFacade.saveOrder(e),this.createOrderForm.reset(),this.eventClose.emit()}getErrorMessage(e){return rt(e)}populateForm(e){e&&(this.personalInfoForm.patchValue({prenom:e.firstName,nom:e.lastName,ville:e.city,nationalite:e.nationality}),e.email?(this.contactPreferenceCtrl.setValue("email"),this.emailForm.patchValue({email:e.email,confirmEmail:e.email})):e.phone&&(this.contactPreferenceCtrl.setValue("phone"),this.phoneCtrl.setValue(e.phone)),this.loginInfoForm.patchValue({username:e.userName,password:e.password,confirmPassword:e.password}),this.orderItemsForm.clear(),e.items.forEach(i=>{this.orderItemsForm.push(this.formBuilder.group({productId:[i.productId,n.kI.required],quantity:[i.quantity,[n.kI.required,n.kI.min(1)]],price:[i.price,[n.kI.required,n.kI.min(0)]]}))}))}onClose(){this.eventClose.emit()}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-update-order"]],inputs:{data:"data"},outputs:{eventClose:"eventClose"},decls:81,vars:15,consts:[[3,"formGroup"],["mat-icon-button","","color","warn",3,"click"],["formGroupName","personalInfo",1,"form-card"],["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","start start",1,"form-row"],["appearance","fill","fxFlex","45"],["type","text","matInput","","formControlName","prenom"],["type","text","matInput","","formControlName","nom"],["type","text","matInput","","formControlName","ville"],["type","text","matInput","","formControlName","nationalite"],[1,"form-card"],[3,"formControl"],["value","email"],["value","phone"],["class","form-card",3,"formGroup",4,"ngIf"],["class","form-card",4,"ngIf"],[1,"form-card",3,"formGroup"],["type","text","matInput","","formControlName","username"],["type","password","matInput","","formControlName","password"],["class","error-text",4,"ngIf"],["type","password","matInput","","formControlName","confirmPassword"],["formArrayName","items"],[4,"ngFor","ngForOf"],["mat-stroked-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",3,"click"],["type","text","matInput","","formControlName","email"],["type","text","matInput","","formControlName","confirmEmail"],[1,"error-text"],["type","text","matInput","",3,"formControl"],[3,"itemForm","index","remove"]],template:function(i,a){1&i&&(t.TgZ(0,"mat-card",0)(1,"div")(2,"button",1),t.NdJ("click",function(){return a.onClose()}),t.TgZ(3,"mat-icon"),t._uU(4,"close"),t.qZA()()(),t.TgZ(5,"mat-card-title"),t._uU(6," Creation d'une Commande"),t.qZA(),t.TgZ(7,"mat-card",2)(8,"mat-card-subtitle"),t._uU(9,"Informationss personnelles"),t.qZA(),t.TgZ(10,"div",3)(11,"mat-form-field",4)(12,"mat-label"),t._uU(13,"Pr\xe9nom"),t.qZA(),t._UZ(14,"input",5),t.TgZ(15,"mat-error"),t._uU(16,"Ce champ est requis"),t.qZA()(),t.TgZ(17,"mat-form-field",4)(18,"mat-label"),t._uU(19,"Nom"),t.qZA(),t._UZ(20,"input",6),t.TgZ(21,"mat-error"),t._uU(22,"Ce champ est requis"),t.qZA()(),t.TgZ(23,"mat-form-field",4)(24,"mat-label"),t._uU(25,"Ville"),t.qZA(),t._UZ(26,"input",7),t.TgZ(27,"mat-error"),t._uU(28,"Ce champ est requis"),t.qZA()(),t.TgZ(29,"mat-form-field",4)(30,"mat-label"),t._uU(31,"Nationalit\xe9"),t.qZA(),t._UZ(32,"input",8),t.TgZ(33,"mat-error"),t._uU(34,"Ce champ est requis"),t.qZA()()()(),t.TgZ(35,"mat-card",9)(36,"mat-card-subtitle"),t._uU(37,"Comment pr\xe9f\xe9rez-vous que l'on vous contacte ?"),t.qZA(),t.TgZ(38,"mat-radio-group",10)(39,"mat-radio-button",11),t._uU(40,"Mail"),t.qZA(),t.TgZ(41,"mat-radio-button",12),t._uU(42,"T\xe9l\xe9phone"),t.qZA()()(),t.YNc(43,It,18,6,"mat-card",13),t.ALo(44,"async"),t.YNc(45,bt,10,2,"mat-card",14),t.ALo(46,"async"),t.TgZ(47,"mat-card",15)(48,"mat-card-subtitle"),t._uU(49,"Informations de connexion"),t.qZA(),t.TgZ(50,"div",3)(51,"mat-form-field",4)(52,"mat-label"),t._uU(53,"Nom d'utilisateur"),t.qZA(),t._UZ(54,"input",16),t.TgZ(55,"mat-error"),t._uU(56,"Ce champ est requis"),t.qZA()()(),t.TgZ(57,"div",3)(58,"mat-form-field",4)(59,"mat-label"),t._uU(60,"Mot de passe"),t.qZA(),t._UZ(61,"input",17),t.TgZ(62,"mat-error"),t._uU(63),t.qZA(),t.YNc(64,At,2,0,"small",18),t.ALo(65,"async"),t.qZA(),t.TgZ(66,"mat-form-field",4)(67,"mat-label"),t._uU(68,"Confirmer votre mot de passe"),t.qZA(),t._UZ(69,"input",19),t.TgZ(70,"mat-error"),t._uU(71),t.qZA()()()(),t.TgZ(72,"mat-card",20)(73,"mat-card-subtitle"),t._uU(74,"Articles de la commande"),t.qZA(),t.YNc(75,Ut,2,2,"ng-container",21),t.TgZ(76,"button",22),t.NdJ("click",function(){return a.addOrderItem()}),t._uU(77,"Ajouter un article"),t.qZA()(),t.TgZ(78,"mat-card-actions")(79,"button",23),t.NdJ("click",function(){return a.onSubmitForm()}),t._uU(80,"ENREGISTRER"),t.qZA()()()),2&i&&(t.Q6J("formGroup",a.createOrderForm),t.xp6(38),t.Q6J("formControl",a.contactPreferenceCtrl),t.xp6(5),t.Q6J("ngIf",t.lcZ(44,9,a.showEmail$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(46,11,a.showPhone$)),t.xp6(2),t.Q6J("formGroup",a.loginInfoForm),t.xp6(16),t.Oqu(a.getErrorMessage(a.passwordCtrl)),t.xp6(1),t.Q6J("ngIf",t.lcZ(65,13,a.showPasswordError$)),t.xp6(7),t.Oqu(a.getErrorMessage(a.confirmPasswordCtrl)),t.xp6(4),t.Q6J("ngForOf",a.orderItemsForm.controls))},dependencies:[d.sg,d.O5,Z.a8,Z.hq,Z.$j,Z.n5,T.lW,T.RK,S.Hw,C.KE,C.hX,C.TO,$.Nt,k.VQ,k.U0,n.Fj,n.JJ,n.JL,n.oH,n.sg,n.u,n.x0,n.CE,u.xw,u.SQ,u.Wh,u.yH,ot,d.Ov],styles:[".error-text[_ngcontent-%COMP%]{color:red}"]}),r})(),CREATE_ORDER:yt};var Nt=l(3683),qt=l(4850),V=l(3267);let wt=(()=>{const o=class{constructor(){this.snackBar=(0,t.f3M)(it.ux)}success(e){this.snackBar.open(e,"OK",{duration:3e3,panelClass:["success"]})}error(e){this.snackBar.open(e,"Fermer",{duration:5e3,panelClass:["error"]})}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),r})();var E=l(7155),Rt=l(1572);function Pt(r,o){1&r&&(t.TgZ(0,"th",15),t._uU(1," Num\xe9ro "),t.qZA())}function Dt(r,o){if(1&r&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.xp6(1),t.hij(" ",s.orderNumber," ")}}function St(r,o){1&r&&(t.TgZ(0,"th",15),t._uU(1," Date "),t.qZA())}function $t(r,o){if(1&r&&(t.TgZ(0,"td",16),t._uU(1),t.ALo(2,"date"),t.qZA()),2&r){const s=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,s.orderDate,"short")," ")}}function kt(r,o){1&r&&(t.TgZ(0,"th",15),t._uU(1," Client "),t.qZA())}function Jt(r,o){if(1&r&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.xp6(1),t.hij(" ",s.lastName," ")}}function Lt(r,o){1&r&&(t.TgZ(0,"th",15),t._uU(1," Statut "),t.qZA())}function Mt(r,o){if(1&r&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.xp6(1),t.hij(" ",s.status," ")}}function Vt(r,o){1&r&&(t.TgZ(0,"th",15),t._uU(1," Actions "),t.qZA())}function Bt(r,o){if(1&r){const s=t.EpF();t.TgZ(0,"td",16)(1,"button",17),t.NdJ("click",function(i){const m=t.CHM(s).$implicit;return t.oxw(2).viewDetails(m),t.KtG(i.stopPropagation())}),t.TgZ(2,"mat-icon"),t._uU(3,"visibility"),t.qZA()(),t.TgZ(4,"button",18),t.NdJ("click",function(i){const m=t.CHM(s).$implicit;return t.oxw(2).deleteOrder(m),t.KtG(i.stopPropagation())}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function Qt(r,o){1&r&&t._UZ(0,"tr",19)}function Gt(r,o){if(1&r){const s=t.EpF();t.TgZ(0,"tr",20),t.NdJ("click",function(){const a=t.CHM(s).$implicit,m=t.oxw(2);return t.KtG(m.viewDetails(a))}),t.qZA()}}function Yt(r,o){if(1&r){const s=t.EpF();t.ynx(0),t.TgZ(1,"div",2)(2,"table",3),t.ynx(3,4),t.YNc(4,Pt,2,0,"th",5),t.YNc(5,Dt,2,1,"td",6),t.BQk(),t.ynx(6,7),t.YNc(7,St,2,0,"th",5),t.YNc(8,$t,3,4,"td",6),t.BQk(),t.ynx(9,8),t.YNc(10,kt,2,0,"th",5),t.YNc(11,Jt,2,1,"td",6),t.BQk(),t.ynx(12,9),t.YNc(13,Lt,2,0,"th",5),t.YNc(14,Mt,2,1,"td",6),t.BQk(),t.ynx(15,10),t.YNc(16,Vt,2,0,"th",5),t.YNc(17,Bt,7,0,"td",6),t.BQk(),t.YNc(18,Qt,1,0,"tr",11),t.YNc(19,Gt,1,0,"tr",12),t.qZA()(),t.TgZ(20,"div",13)(21,"button",14),t.NdJ("click",function(){t.CHM(s);const i=t.oxw();return t.KtG(i.createDetails())}),t.TgZ(22,"mat-icon"),t._uU(23,"add"),t.qZA()()(),t.BQk()}if(2&r){const s=o.ngIf,e=t.oxw();t.xp6(2),t.Q6J("dataSource",s),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function zt(r,o){1&r&&(t.TgZ(0,"div",21),t._UZ(1,"mat-spinner"),t.TgZ(2,"p"),t._uU(3,"Chargement des commandes..."),t.qZA()())}let Ht=(()=>{const o=class{constructor(){this.orderUiFacade=(0,t.f3M)(F),this.actionService=(0,t.f3M)(et),this.dialogService=(0,t.f3M)(M),this.notificationService=(0,t.f3M)(wt),this.destroy$=new A.x,this.displayedColumns=["orderNumber","orderDate","customerId","status","actions"]}ngOnInit(){this.initializeOrders()}initializeOrders(){this.order$=this.orderUiFacade.order$.pipe((0,y.R)(this.destroy$)),this.orderUiFacade.error$.pipe((0,y.R)(this.destroy$),(0,f.b)(()=>{this.dialogService.error("Impossible de charger la liste des commandes"),this.notificationService.error("Impossible de charger la liste des commandes")})).subscribe()}viewDetails(e){this.actionService.emit({type:h.VIEW_ORDER,payload:e})}createDetails(){this.actionService.emit({type:h.CREATE_ORDER})}deleteOrder(e){this.actionService.emit({type:h.DELETE_ORDER,payload:e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-table-display"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"orders-table"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","orderNumber"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","orderDate"],["matColumnDef","customerId"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"bottom-left"],["mat-fab","","color","primary",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row","",3,"click"],[1,"loading-container"]],template:function(i,a){if(1&i&&(t.YNc(0,Yt,24,3,"ng-container",0),t.ALo(1,"async"),t.YNc(2,zt,4,0,"ng-template",null,1,t.W1O)),2&i){const m=t.MAs(3);t.Q6J("ngIf",t.lcZ(1,2,a.order$))("ngIfElse",m)}},dependencies:[d.O5,T.RK,T.cs,S.Hw,E.BZ,E.fO,E.as,E.w1,E.Dz,E.nj,E.ge,E.ev,E.XQ,E.Gk,Rt.Ou,d.Ov,d.uU],styles:['@charset "UTF-8";.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:2rem;color:#666}.orders-table[_ngcontent-%COMP%]{width:70%;max-width:100%;height:auto;margin:0 auto;margin-top:2rem}.bottom-left[_ngcontent-%COMP%]{position:absolute;bottom:16px;left:16px;display:flex;align-items:center;justify-content:flex-start}']}),r})();var jt=l(4385),Kt=l(3238);function Wt(r,o){if(1&r&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.Q6J("value",s),t.xp6(1),t.Oqu(s)}}function Xt(r,o){if(1&r&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.Q6J("value",s),t.xp6(1),t.Oqu(s)}}function te(r,o){if(1&r&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.Q6J("value",s),t.xp6(1),t.Oqu(s)}}function ee(r,o){if(1&r&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&r){const s=o.$implicit;t.Q6J("value",s),t.xp6(1),t.Oqu(s)}}let re=(()=>{const o=class{constructor(){this.formBuildre=(0,t.f3M)(n.qu),this.operatorOptions=["=","!=",">","<","contains"],this.fields=["orderNumber","orderDate","customerId","status"],this.criteriaChange=new t.vpe}ngOnInit(){this.initFiltreForm()}initFiltreForm(){const e=this.fields.reduce((i,a)=>(i[`${a}Value`]=this.formBuildre.control(""),i[`${a}Operator`]=this.formBuildre.control("="),i),{});this.filtreForm=this.formBuildre.group(e)}chercher(){const e=this.filtreForm?.value,i=[];this.fields.forEach(a=>{const m=e[`${a}Value`];m&&i.push({name:a,value:m,operator:e[`${a}Operator`]})}),console.table(`test dd : ${i}`),this.criteriaChange.emit(i)}reinitialiser(){this.filtreForm?.reset(),this.fields.forEach(e=>{this.filtreForm.get(`${e}Operator`)?.patchValue("=")}),this.criteriaChange.emit([])}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-table-filter"]],outputs:{criteriaChange:"criteriaChange"},decls:46,vars:5,consts:[["fxLayout","row","fxLayoutGap","32px","fxLayoutAlign","start start",1,"filter-row",3,"formGroup"],["fxFlex","25","fxLayout","column","fxLayoutGap","8px"],["appearance","outline"],["matInput","","formControlName","orderNumberValue"],["formControlName","orderNumberOperator"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","orderDateValue"],["formControlName","orderDateOperator"],["matInput","","formControlName","customerIdValue"],["formControlName","customerIdOperator"],["matInput","","formControlName","statusValue"],["formControlName","statusOperator"],["fxFlex","25","fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","20px"],["mat-raised-button","","color","primary",3,"click"],["mat-stroked-button","","color","warn",3,"click"],[3,"value"]],template:function(i,a){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),t._uU(4,"Nom"),t.qZA(),t._UZ(5,"input",3),t.qZA(),t.TgZ(6,"mat-form-field",2)(7,"mat-label"),t._uU(8,"Op\xe9rateur"),t.qZA(),t.TgZ(9,"mat-select",4),t.YNc(10,Wt,2,2,"mat-option",5),t.qZA()()(),t.TgZ(11,"div",1)(12,"mat-form-field",2)(13,"mat-label"),t._uU(14,"Statut"),t.qZA(),t._UZ(15,"input",6),t.qZA(),t.TgZ(16,"mat-form-field",2)(17,"mat-label"),t._uU(18,"Op\xe9rateur"),t.qZA(),t.TgZ(19,"mat-select",7),t.YNc(20,Xt,2,2,"mat-option",5),t.qZA()()(),t.TgZ(21,"div",1)(22,"mat-form-field",2)(23,"mat-label"),t._uU(24,"Quantit\xe9"),t.qZA(),t._UZ(25,"input",8),t.qZA(),t.TgZ(26,"mat-form-field",2)(27,"mat-label"),t._uU(28,"Op\xe9rateur"),t.qZA(),t.TgZ(29,"mat-select",9),t.YNc(30,te,2,2,"mat-option",5),t.qZA()()(),t.TgZ(31,"div",1)(32,"mat-form-field",2)(33,"mat-label"),t._uU(34,"Cat\xe9gorie"),t.qZA(),t._UZ(35,"input",10),t.qZA(),t.TgZ(36,"mat-form-field",2)(37,"mat-label"),t._uU(38,"Op\xe9rateur"),t.qZA(),t.TgZ(39,"mat-select",11),t.YNc(40,ee,2,2,"mat-option",5),t.qZA()()(),t.TgZ(41,"div",12)(42,"button",13),t.NdJ("click",function(){return a.chercher()}),t._uU(43," Chercher "),t.qZA(),t.TgZ(44,"button",14),t.NdJ("click",function(){return a.reinitialiser()}),t._uU(45," R\xe9initialiser "),t.qZA()()()),2&i&&(t.Q6J("formGroup",a.filtreForm),t.xp6(10),t.Q6J("ngForOf",a.operatorOptions),t.xp6(10),t.Q6J("ngForOf",a.operatorOptions),t.xp6(10),t.Q6J("ngForOf",a.operatorOptions),t.xp6(10),t.Q6J("ngForOf",a.operatorOptions))},dependencies:[d.sg,T.lW,C.KE,C.hX,$.Nt,jt.gD,Kt.ey,n.Fj,n.JJ,n.JL,n.sg,n.u,u.xw,u.SQ,u.Wh,u.yH],styles:[".filter-row[_ngcontent-%COMP%]{width:70%;max-width:1200px;height:auto;min-height:120px;margin:0 auto;margin-top:2rem}"]}),r})();var oe=l(7974);const ie=function(){return[5,10,25,100]};function ae(r,o){if(1&r){const s=t.EpF();t.TgZ(0,"mat-paginator",1),t.NdJ("page",function(i){t.CHM(s);const a=t.oxw();return t.KtG(a.onPageChange(i))}),t.qZA()}if(2&r){const s=o.ngIf;t.Q6J("length",10)("length",s.totalElements)("pageSize",s.size)("pageSizeOptions",t.DdM(4,ie))}}let ne=(()=>{const o=class{constructor(){this.orderUiFacade=(0,t.f3M)(F),this.destroy$=new A.x,this.pageChange=new t.vpe}ngOnInit(){this.initializeOrders()}initializeOrders(){this.page$=this.orderUiFacade.page$.pipe((0,y.R)(this.destroy$))}onPageChange(e){this.pageChange.emit(e?.pageIndex||0)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-table-pagination"]],outputs:{pageChange:"pageChange"},decls:2,vars:3,consts:[["aria-label","Select page",3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions","page"]],template:function(i,a){1&i&&(t.YNc(0,ae,1,5,"mat-paginator",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,a.page$))},dependencies:[d.O5,oe.NW,d.Ov]}),r})();const se=["sidePanel"],le=["dynamicHost"],me=[{path:"",component:(()=>{const o=class extends _t{constructor(){super(...arguments),this.orderUiFacade=(0,t.f3M)(F)}ngOnInit(){super.init(),this.loadOrders()}loadOrders(){this.orderUiFacade.init()}getSupportedActionTypes(){return[h.DELETE_ORDER,h.UPDATE_ORDER,h.VIEW_ORDER,h.CREATE_ORDER]}handleAction(e){e.type===h.DELETE_ORDER?this.confirmAndDelete(e.payload):this.openDynamicComponent(e)}confirmAndDelete(e){const i=X_confirmGeneric((r=>`Voulez-vous vraiment supprimer la commande #${r.orderNumber} ?`)(e));this.dialogService.confirm(i).pipe((0,y.R)(this.destroy$),(0,G.h)(a=>a),(0,N.w)(()=>this.retryWithUserConfirmation(this.orderUiFacade.deleteOrder(e),(r=>`Erreur lors de la suppression de la commande ${r.orderNumber}. Voulez-vous r\xe9essayer ?`)(e),3))).subscribe({next:()=>this.dialogService.success((r=>`Commande #${r.orderNumber} est supprim\xe9e`)(e)),error:()=>this.dialogService.error((r=>`Commande #${r.orderNumber} n'est pas supprim\xe9e`)(e))})}openDynamicComponent(e){const i=Ft[e.type];i&&(this.currentComponentRef=this.dynamicLoaderService.createComponent(this.dynamicHost,i,{data:e.payload},()=>this.closePanel()),this.sidePanel.open())}onPageReceived(e){this.orderUiFacade.setPage(e)}onCriteriaReceived(e){this.orderUiFacade.setCriteria(e)}closePanel(){this.currentComponentRef?.destroy(),this.currentComponentRef=void 0,this.sidePanel.close(),this.dynamicHost.clear()}ngOnDestroy(){this.orderUiFacade.destroy(),super.destroy()}};let r=o;return o.\u0275fac=function(){let e;return function(a){return(e||(e=t.n5z(o)))(a||o)}}(),o.\u0275cmp=t.Xpm({type:o,selectors:[["app-order"]],viewQuery:function(i,a){if(1&i&&(t.Gf(se,5),t.Gf(le,5,t.s_b)),2&i){let m;t.iGM(m=t.CRH())&&(a.sidePanel=m.first),t.iGM(m=t.CRH())&&(a.dynamicHost=m.first)}},features:[t.qOj],decls:16,vars:1,consts:[[1,"sidenav-container"],["mode","side","position","end",1,"side-panel",3,"fixedInViewport"],["sidePanel",""],["dynamicHost",""],["color","primary",1,"main-toolbar"],[1,"content-wrapper"],[3,"criteriaChange"],[3,"pageChange"]],template:function(i,a){1&i&&(t.TgZ(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),t.GkF(3,null,3),t.qZA(),t.TgZ(5,"mat-sidenav-content")(6,"mat-toolbar",4)(7,"span"),t._uU(8,"Gestion des commandes"),t.qZA()(),t.TgZ(9,"div",5)(10,"mat-card")(11,"mat-card-content")(12,"app-table-filter",6),t.NdJ("criteriaChange",function(c){return a.onCriteriaReceived(c)}),t.qZA(),t._UZ(13,"mat-divider")(14,"app-table-display"),t.TgZ(15,"app-table-pagination",7),t.NdJ("pageChange",function(c){return a.onPageReceived(c)}),t.qZA()()()()()()),2&i&&(t.xp6(1),t.Q6J("fixedInViewport",!0))},dependencies:[Nt.Ye,Z.a8,Z.dn,qt.d,V.JX,V.TM,V.Rh,Ht,re,ne],styles:['@charset "UTF-8";.side-panel[_ngcontent-%COMP%]{width:45%;max-width:45vw;min-width:20em;padding:16px;box-sizing:border-box;overflow:auto;transition:width .3s ease}@media (max-width: 768px){.side-panel[_ngcontent-%COMP%]{width:100%;max-width:100vw}}.close-button-container[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px}.main-toolbar[_ngcontent-%COMP%]{margin-bottom:16px}.content-wrapper[_ngcontent-%COMP%]{padding:16px}']}),r})()}];let ce=(()=>{const o=class{};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[Q.Bz.forChild(me),Q.Bz]}),r})();var ue=l(5222);let de=(()=>{const o=class{};let r=o;return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[K,W,F],imports:[ue.m,ce]}),r})()}}]);